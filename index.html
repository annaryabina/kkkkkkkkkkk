<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–≠–∫–æ–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ¬∑ –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Å AccuWeather</title>
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(145deg, #0b2f3e, #154c5c);
            color: #1e2e3e;
            padding: 20px;
        }
        .container { max-width: 1400px; margin: 0 auto; }

        /* –®–∞–ø–∫–∞ —Å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–º */
        header {
            background: rgba(255,255,255,0.98);
            backdrop-filter: blur(10px);
            padding: 20px 35px;
            border-radius: 30px;
            margin-bottom: 35px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
           // ---------- 100% –†–ê–ë–û–ß–ò–ô CORS-–ü–†–û–ö–°–ò –î–õ–Ø –†–û–°–°–ò–ò ----------
const CORS_PROXY = 'https://cors.zadzmo.org/';
// ---------------------------------------------------------
            display: flex;
            gap: 10px;
            background: #eaf0f5;
            padding: 6px;
            border-radius: 60px;
        }
        .city-btn {
            border: none;
            padding: 12px 28px;
            border-radius: 50px;
            font-size: 1.05em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            background: transparent;
            color: #2f4a62;
            transition: 0.25s;
        }
        .city-btn.active {
            background: white;
            color: #1d4e6b;
            box-shadow: 0 8px 20px rgba(0,60,100,0.2);
        }

        .update-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: 0.3s;
        }
        .update-btn:hover { background: #2980b9; transform: scale(1.03); }
        .update-btn i { font-size: 1.1em; }

        /* –°—Ç–∞—Ç—É—Å-–±–∞—Ä */
        .overall-status {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(6px);
            padding: 18px 30px;
            border-radius: 60px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .aqi-large {
            font-size: 2.8em;
            font-weight: 800;
            margin-left: 10px;
            line-height: 1;
        }
        .timestamp {
            font-family: monospace;
            background: rgba(0,0,0,0.2);
            padding: 6px 16px;
            border-radius: 40px;
            font-size: 0.95em;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ AQI */
        .aqi-hero {
            background: white;
            border-radius: 32px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
        }
        .aqi-circle {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .aqi-number { font-size: 3.8em; line-height: 1; }
        .aqi-label { font-size: 1.1em; text-transform: uppercase; letter-spacing: 2px; }
        .aqi-desc { font-size: 1.3em; font-weight: 600; margin-bottom: 10px; }
        .aqi-meta { color: #4a6980; }

        /* –°–µ—Ç–∫–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π (–±–µ–∑ AQI, —Ç–æ–ª—å–∫–æ –¥–æ–ø. —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞) */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 24px;
            box-shadow: 0 15px 25px rgba(0,0,0,0.05);
            border-bottom: 6px solid;
        }
        .stat-card.good { border-bottom-color: #2ecc71; }
        .stat-card.moderate { border-bottom-color: #f39c12; }
        .stat-card.bad { border-bottom-color: #e74c3c; }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        .stat-header i { font-size: 2em; color: #34657f; }
        .stat-value { font-size: 2.4em; font-weight: 700; color: #0a2e3b; }
        .stat-label { color: #4a6980; font-size: 0.85em; text-transform: uppercase; }

        /* –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ */
        .alert-section {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        .alerts-card, .advice-card {
            background: white;
            border-radius: 28px;
            padding: 28px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }
        .alert-item {
            background: #fff5f0;
            border-left: 6px solid #e74c3c;
            padding: 18px;
            border-radius: 0 20px 20px 0;
            margin-bottom: 14px;
            display: flex;
            gap: 18px;
        }
        .advice-item {
            background: #eef8f2;
            border-left: 6px solid #2ecc71;
            padding: 18px;
            border-radius: 0 20px 20px 0;
            display: flex;
            gap: 18px;
            margin-bottom: 14px;
        }
        .source-info {
            margin-top: 18px;
            padding-top: 16px;
            border-top: 2px dashed #a0c0d0;
            color: #2e6279;
            font-style: italic;
        }

        .footer {
            text-align: center;
            padding: 30px;
            background: rgba(0,0,0,0.2);
            border-radius: 50px;
            color: rgba(255,255,255,0.9);
            margin-top: 20px;
        }

        @media (max-width: 800px) {
            header { flex-direction: column; }
            .city-switcher { justify-content: center; }
            .alert-section { grid-template-columns: 1fr; }
            .aqi-hero { flex-direction: column; text-align: center; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –®–ê–ü–ö–ê -->
        <header>
            <div class="logo">
                <i class="fas fa-cloud-sun"></i>
                <h1>–≠–∫–æ–†–µ–∞–ª</h1>
            </div>
            <div class="city-switcher" id="citySwitcher">
                <button class="city-btn active" data-city="lipetsk"><i class="fas fa-industry"></i> –õ–∏–ø–µ—Ü–∫</button>
                <button class="city-btn" data-city="moscow"><i class="fas fa-city"></i> –ú–æ—Å–∫–≤–∞</button>
                <button class="city-btn" data-city="spb"><i class="fas fa-water"></i> –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</button>
            </div>
            <button class="update-btn" id="forceUpdateBtn">
                <i class="fas fa-rotate"></i> –û–±–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å
            </button>
        </header>

        <!-- –ë–õ–û–ö –¢–ï–ö–£–©–ï–ì–û AQI (–ø–∞—Ä—Å–∏—Ç—Å—è —Å AccuWeather) -->
        <div class="overall-status" id="overallStatus">
            <span id="cityNameDisplay">–õ–∏–ø–µ—Ü–∫</span>
            <span class="aqi-large" id="aqiBigValue">--</span>
            <span id="aqiCategoryDisplay">–∑–∞–≥—Ä—É–∑–∫–∞...</span>
            <span class="timestamp" id="updateTimestamp">‚è± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ...</span>
        </div>

        <!-- –û–°–ù–û–í–ù–ê–Ø –ö–ê–†–¢–û–ß–ö–ê AQI -->
        <div class="aqi-hero" id="aqiHeroCard">
            <div class="aqi-circle" id="aqiCircle" style="background: #7f8c8d;">
                <span class="aqi-number" id="aqiCircleNumber">--</span>
                <span class="aqi-label" id="aqiCircleLabel">AQI</span>
            </div>
            <div style="flex: 1; margin-left: 30px;">
                <div class="aqi-desc" id="aqiDescription">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                <div class="aqi-meta" id="aqiMeta">–ò—Å—Ç–æ—á–Ω–∏–∫: AccuWeather ¬∑ –ø–∞—Ä—Å–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</div>
                <div style="margin-top: 15px; color: #2ecc71;" id="aqiAdvice"></div>
            </div>
        </div>

        <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê (PM2.5, –≤—ã–±—Ä–æ—Å—ã, –æ–∑–µ–ª–µ–Ω–µ–Ω–∏–µ - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ) -->
        <div class="stats-grid" id="statsGrid"></div>

        <!-- –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò -->
        <div class="alert-section">
            <div class="alerts-card">
                <h3 style="display:flex; gap:12px;"><i class="fas fa-exclamation-triangle" style="color:#e74c3c;"></i> –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</h3>
                <div id="alertsList"></div>
            </div>
            <div class="advice-card">
                <h3 style="display:flex; gap:12px;"><i class="fas fa-circle-info" style="color:#2ecc71;"></i> –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
                <div id="adviceList"></div>
            </div>
        </div>

        <div class="footer">
            <p>¬© 2026 ¬∑ –î–∞–Ω–Ω—ã–µ AQI –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å AccuWeather (–ø–∞—Ä—Å–∏–Ω–≥ <span id="parsedCity">–õ–∏–ø–µ—Ü–∫</span>)</p>
        </div>
    </div>

    <script>
        // ==================================================
        //   –ü–ê–†–°–ò–ù–ì ACCUWEATHER –í –†–ï–ê–õ–¨–ù–û–ú –í–†–ï–ú–ï–ù–ò (CORS)
        //   –¶–ï–õ–ï–í–´–ï –ö–õ–ê–°–°–´: <div class="aq-number">–ß–ò–°–õ–û</div>
        // ==================================================

        // ---------- –ù–ê–°–¢–†–û–ô–ö–ê: –í–´–ë–ï–†–ò–¢–ï –†–ê–ë–û–ß–ò–ô CORS-–ü–†–û–ö–°–ò ----------
        // –í–ê–ñ–ù–û! AccuWeather –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –±—Ä–∞—É–∑–µ—Ä–∞.
        // –†–ê–°–ö–û–ú–ú–ï–ù–¢–ò–†–£–ô–¢–ï –û–î–ù–£ –ò–ó –°–¢–†–û–ö –ù–ò–ñ–ï, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –≤–∞—à–µ–º —Ä–µ–≥–∏–æ–Ω–µ.
        const CORS_PROXY = ''; // ‚Üê –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ –í–´–ö–õ–Æ–ß–ï–ù–û. –í–´–ë–ï–†–ò–¢–ï –ü–†–û–ö–°–ò –ù–ò–ñ–ï.
        
        // –í–∞—Ä–∏–∞–Ω—Ç A: Allorigins (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –†–æ—Å—Å–∏–∏? —á–∞—Å—Ç–æ –¥–∞)
        // const CORS_PROXY = 'https://api.allorigins.win/raw?url='; 
        
        // –í–∞—Ä–∏–∞–Ω—Ç B: CORS-–ø—Ä–æ–∫—Å–∏ –æ—Ç thingproxy
        // const CORS_PROXY = 'https://thingproxy.freeboard.io/fetch/';
        
        // –í–∞—Ä–∏–∞–Ω—Ç C: CORS anywhere (—Ç—Ä–µ–±—É–µ—Ç –∫–ª—é—á, –Ω–æ –µ—Å—Ç—å –¥–µ–º–æ)
        // const CORS_PROXY = 'https://cors-anywhere.herokuapp.com/';
        
        // –í–∞—Ä–∏–∞–Ω—Ç D: –í–∞—à –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
        // const CORS_PROXY = 'http://localhost:8080/';
        // -------------------------------------------------------------

        // –°—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã AQI AccuWeather
        const AQI_URLS = {
            lipetsk: 'https://www.accuweather.com/ru/ru/lipetsk/293886/air-quality-index/293886',
            moscow: 'https://www.accuweather.com/ru/ru/moscow/294021/air-quality-index/294021',
            spb: 'https://www.accuweather.com/ru/ru/saint-petersburg/295212/air-quality-index/295212'
        };

        // –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (–≤—ã–±—Ä–æ—Å—ã, –æ–∑–µ–ª–µ–Ω–µ–Ω–∏–µ, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)
        const CITY_STATIC = {
            lipetsk: {
                name: '–õ–∏–ø–µ—Ü–∫',
                pm25: 35, emissions: 245, green: 24,
                alerts: [
                    { icon: 'industry', title: '–õ–µ–≤–æ–±–µ—Ä–µ–∂–Ω—ã–π ‚Äî –ù–õ–ú–ö', text: '–§–æ—Ä–º–∞–ª—å–¥–µ–≥–∏–¥ 1.8 –ü–î–ö', time: '–ø–∞—Ä—Å–∏–Ω–≥ AQI' },
                    { icon: 'car', title: '–û–∫—Ç—è–±—Ä—å—Å–∫–∏–π —Ä–∞–π–æ–Ω', text: '–ü–æ–≤—ã—à–µ–Ω–Ω—ã–π NO‚ÇÇ', time: '–∞–∫—Ç—É–∞–ª—å–Ω–æ' }
                ],
                advices: [
                    { icon: 'mask', text: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞—Å–∫–∏ –≤ –ø—Ä–æ–º–∑–æ–Ω–∞—Ö' },
                    { icon: 'wind', text: '–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–π—Ç–µ —É—Ç—Ä–æ–º' },
                    { icon: 'leaf', text: '–ö–æ–º–Ω–∞—Ç–Ω—ã–µ —Ä–∞—Å—Ç–µ–Ω–∏—è' }
                ]
            },
            moscow: {
                name: '–ú–æ—Å–∫–≤–∞',
                pm25: 10, emissions: 125, green: 49,
                alerts: [
                    { icon: 'industry', title: '–ö–∞–ø–æ—Ç–Ω—è ‚Äî –ù–ü–ó', text: '–ó–æ–Ω–∞ –≤–ª–∏—è–Ω–∏—è', time: '–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥' },
                    { icon: 'car', title: '–ó–∞–ø–∞–¥–Ω–æ–µ –î–µ–≥—É–Ω–∏–Ω–æ', text: '–í—ã–±—Ä–æ—Å—ã –∞–≤—Ç–æ—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞', time: '–∞–∫—Ç—É–∞–ª—å–Ω–æ' }
                ],
                advices: [
                    { icon: 'bicycle', text: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ–ª–æ–ø—Ä–æ–∫–∞—Ç' },
                    { icon: 'seedling', text: '–û–∑–µ–ª–µ–Ω–µ–Ω–∏–µ –¥–≤–æ—Ä–æ–≤' },
                    { icon: 'house', text: '–ë—Ä–∏–∑–µ—Ä —Å HEPA' }
                ]
            },
            spb: {
                name: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',
                pm25: 12, emissions: 98, green: 40,
                alerts: [
                    { icon: 'industry', title: '–ö–æ–ª–ø–∏–Ω–æ ‚Äî –ò–∂–æ—Ä—Å–∫–∏–µ –∑–∞–≤–æ–¥—ã', text: '–î–∏–æ–∫—Å–∏–¥ —Å–µ—Ä—ã', time: '3 —Ñ–µ–≤' },
                    { icon: 'ship', title: '–ú–æ—Ä—Å–∫–æ–π –ø–æ—Ä—Ç', text: '–ü—ã–ª–µ–Ω–∏–µ —É–≥–ª—è', time: '–≤—á–µ—Ä–∞' }
                ],
                advices: [
                    { icon: 'umbrella', text: '–û—á–∏—Å—Ç–∏—Ç–µ–ª–∏ –≤–æ–∑–¥—É—Ö–∞' },
                    { icon: 'train', text: '–≠–ª–µ–∫—Ç—Ä–∏—á–∫–∏ –≤ –ø—Ä–æ–º–∑–æ–Ω—ã' },
                    { icon: 'island', text: '–ö—É—Ä–æ—Ä—Ç–Ω—ã–π —Ä–∞–π–æ–Ω' }
                ]
            }
        };

        let currentCity = 'lipetsk';
        let currentAQI = null;
        let lastUpdate = null;

        // ========== –ü–ê–†–°–ò–ù–ì AQI –° ACCUWEATHER ==========
        async function fetchAQI(city) {
            const url = AQI_URLS[city];
            if (!url) return null;
            
            // –ï—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º–æ–π fetch (–Ω–æ AccuWeather –µ–≥–æ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç)
            const fetchUrl = CORS_PROXY ? CORS_PROXY + encodeURIComponent(url) : url;
            
            try {
                console.log(`üîÑ –ó–∞–ø—Ä–æ—Å AQI –¥–ª—è ${city}: ${fetchUrl}`);
                
                const response = await fetch(fetchUrl);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const html = await response.text();
                console.log(`üìÑ –ü–æ–ª—É—á–µ–Ω HTML (${html.length} —Å–∏–º–≤–æ–ª–æ–≤)`);
                
                // 1. –ü–∞—Ä—Å–∏–º <div class="aq-number">–ß–ò–°–õ–û</div>
                const aqNumberRegex = /<div class="aq-number">(\d+)<\/div>/i;
                const match = html.match(aqNumberRegex);
                
                if (match && match[1]) {
                    const aqiValue = parseInt(match[1], 10);
                    console.log(`‚úÖ –ù–∞–π–¥–µ–Ω AQI –¥–ª—è ${city}: ${aqiValue}`);
                    return aqiValue;
                }
                
                // 2. –†–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: –∏—â–µ–º "AQI" –∏ —á–∏—Å–ª–æ —Ä—è–¥–æ–º
                const aqiRegex = /AQI[^0-9]*(\d{1,3})/i;
                const fallbackMatch = html.match(aqiRegex);
                if (fallbackMatch && fallbackMatch[1]) {
                    const aqiValue = parseInt(fallbackMatch[1], 10);
                    console.log(`‚ö†Ô∏è –ù–∞–π–¥–µ–Ω AQI (—Ä–µ–∑–µ—Ä–≤) –¥–ª—è ${city}: ${aqiValue}`);
                    return aqiValue;
                }
                
                console.error('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ aq-number –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ');
                return null;
            } catch (error) {
                console.error(`‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ ${city}:`, error);
                return null;
            }
        }

        // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï –í–°–ï–ì–û –ò–ù–¢–ï–†–§–ï–ô–°–ê ==========
        async function updateAll(city) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            document.getElementById('aqiCircleNumber').innerText = '--';
            document.getElementById('aqiBigValue').innerText = '--';
            document.getElementById('aqiDescription').innerText = '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...';
            
            // –ü–∞—Ä—Å–∏–º AQI
            const aqi = await fetchAQI(city);
            currentAQI = aqi;
            lastUpdate = new Date();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            renderCityUI(city, aqi);
        }

        function renderCityUI(city, aqi) {
            const staticData = CITY_STATIC[city];
            if (!staticData) return;

            // 1. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å-–±–∞—Ä
            document.getElementById('cityNameDisplay').innerText = staticData.name;
            document.getElementById('aqiBigValue').innerText = aqi !== null ? aqi : '--';
            document.getElementById('updateTimestamp').innerHTML = `‚è± ${lastUpdate ? lastUpdate.toLocaleTimeString() : '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}`;
            
            // 2. –ö–∞—Ç–µ–≥–æ—Ä–∏—è AQI –∏ —Ü–≤–µ—Ç
            let category = '', color = '', description = '', advice = '';
            if (aqi !== null) {
                if (aqi <= 19) { category = '–û—Ç–ª–∏—á–Ω—ã–π'; color = '#2ecc71'; description = '–ö–∞—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞ –∏–¥–µ–∞–ª—å–Ω–æ–µ'; advice = '–ú–æ–∂–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞ —É–ª–∏—Ü–µ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π'; }
                else if (aqi <= 49) { category = '–°—Ä–µ–¥–Ω–∏–π'; color = '#f39c12'; description = '–ü—Ä–∏–µ–º–ª–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å'; advice = '–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –ª—é–¥—è–º —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –ø—Ä–µ–±—ã–≤–∞–Ω–∏–µ –Ω–∞ —É–ª–∏—Ü–µ'; }
                else if (aqi <= 99) { category = '–ü–ª–æ—Ö–æ–π'; color = '#e67e22'; description = '–í—Ä–µ–¥–Ω–æ –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø'; advice = '–°–æ–∫—Ä–∞—Ç–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞ —É–ª–∏—Ü–µ'; }
                else if (aqi <= 149) { category = '–í—Ä–µ–¥–Ω—ã–π'; color = '#e74c3c'; description = '–í—Ä–µ–¥–Ω–æ –¥–ª—è –≤—Å–µ—Ö'; advice = '–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø—Ä–µ–±—ã–≤–∞–Ω–∏–µ –Ω–∞ —É–ª–∏—Ü–µ'; }
                else if (aqi <= 249) { category = '–û—á–µ–Ω—å –≤—Ä–µ–¥–Ω—ã–π'; color = '#8e44ad'; description = '–û–ø–∞—Å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å'; advice = '–ò–∑–±–µ–≥–∞–π—Ç–µ –≤—ã—Ö–æ–¥–∞ –Ω–∞ —É–ª–∏—Ü—É'; }
                else { category = '–û–ø–∞—Å–Ω–æ'; color = '#c0392b'; description = '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å'; advice = '–û—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏'; }
                
                document.getElementById('aqiCategoryDisplay').innerText = `${category} (${aqi} AQI)`;
                document.getElementById('aqiCircle').style.background = color;
                document.getElementById('aqiCircleNumber').innerText = aqi;
                document.getElementById('aqiDescription').innerText = description;
                document.getElementById('aqiAdvice').innerHTML = `<i class="fas fa-info-circle"></i> ${advice}`;
            } else {
                document.getElementById('aqiCategoryDisplay').innerText = '–î–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã';
                document.getElementById('aqiCircle').style.background = '#7f8c8d';
                document.getElementById('aqiCircleNumber').innerText = '?';
                document.getElementById('aqiDescription').innerText = '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å AQI —Å AccuWeather';
                document.getElementById('aqiAdvice').innerHTML = '<i class="fas fa-exclamation-triangle"></i> –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CORS-–ø—Ä–æ–∫—Å–∏';
            }

            // 3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (PM2.5, –≤—ã–±—Ä–æ—Å—ã, –æ–∑–µ–ª–µ–Ω–µ–Ω–∏–µ)
            const statsHtml = `
                <div class="stat-card ${staticData.pm25 > 25 ? 'moderate' : 'good'}">
                    <div class="stat-header"><i class="fas fa-microscope"></i></div>
                    <div class="stat-value">${staticData.pm25}</div>
                    <div class="stat-label">PM2.5 (–º–∫–≥/–º¬≥)</div>
                </div>
                <div class="stat-card good">
                    <div class="stat-header"><i class="fas fa-factory"></i></div>
                    <div class="stat-value">${staticData.emissions}</div>
                    <div class="stat-label">–í—ã–±—Ä–æ—Å—ã (—Ç—ã—Å.—Ç)</div>
                </div>
                <div class="stat-card good">
                    <div class="stat-header"><i class="fas fa-leaf"></i></div>
                    <div class="stat-value">${staticData.green}%</div>
                    <div class="stat-label">–û–∑–µ–ª–µ–Ω–µ–Ω–∏–µ</div>
                </div>
                <div class="stat-card good">
                    <div class="stat-header"><i class="fas fa-clock"></i></div>
                    <div class="stat-value">${aqi !== null ? aqi : '?'}</div>
                    <div class="stat-label">AQI (—Ç–µ–∫—É—â–∏–π)</div>
                </div>
            `;
            document.getElementById('statsGrid').innerHTML = statsHtml;

            // 4. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
            let alertsHtml = '';
            staticData.alerts.forEach(a => {
                alertsHtml += `<div class="alert-item">
                    <i class="fas fa-${a.icon}"></i>
                    <div><strong>${a.title}</strong><br>${a.text}<div style="color:#587b8c; font-size:0.85em;">‚è± ${a.time}</div></div>
                </div>`;
            });
            document.getElementById('alertsList').innerHTML = alertsHtml;

            let advicesHtml = '';
            staticData.advices.forEach(a => {
                advicesHtml += `<div class="advice-item">
                    <i class="fas fa-${a.icon}"></i>
                    <div>${a.text}</div>
                </div>`;
            });
            document.getElementById('adviceList').innerHTML = advicesHtml;
            document.getElementById('parsedCity').innerText = staticData.name;
        }

        // ========== –ê–í–¢–û–û–ë–ù–û–í–õ–ï–ù–ò–ï ==========
        function startAutoUpdate(intervalMinutes = 5) {
            // –ü–µ—Ä–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ä–∞–∑—É
            updateAll(currentCity);
            
            // –ó–∞—Ç–µ–º –∫–∞–∂–¥—ã–µ N –º–∏–Ω—É—Ç
            setInterval(() => {
                console.log('‚è∞ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ...');
                updateAll(currentCity);
            }, intervalMinutes * 60 * 1000);
        }

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        window.addEventListener('load', () => {
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–æ–≤
            document.querySelectorAll('.city-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.city-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentCity = this.dataset.city;
                    updateAll(currentCity);
                });
            });

            // –ö–Ω–æ–ø–∫–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            document.getElementById('forceUpdateBtn').addEventListener('click', () => {
                updateAll(currentCity);
            });

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∫—Å–∏
            if (!CORS_PROXY) {
                alert('‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: CORS-–ø—Ä–æ–∫—Å–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω!\n\nAccuWeather –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞.\n\nüëâ –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –æ–¥–Ω—É –∏–∑ —Å—Ç—Ä–æ–∫ CORS_PROXY –≤ –∫–æ–¥–µ (—Å—Ç—Ä–æ–∫–∞ ~30-40).\n\n–°–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä—è–º–æ–π fetch, –∫–æ—Ç–æ—Ä—ã–π, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç.');
            }

            // –°—Ç–∞—Ä—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
            startAutoUpdate(5);
        });
    </script>
</body>
</html>